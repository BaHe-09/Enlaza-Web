<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detección de Lengua de Señas Mexicana</title>
    <style>
        /* Estilos generales */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            color: #212529;
            background: linear-gradient(135deg, #313d49, #2f547a, #212529); /* Degradado de fondo */
            height: 100vh;
        }
        /* Agregar un poco de estilo para el video */
        #video {
            width: 100%;
            border-radius: 10px;
        }
        .prediction-text {
            font-size: 1.2rem;
            color: white;
            margin-top: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        <h1 style="text-align:center; color:white;">Prototipo de Detección LSM</h1>
    </header>

    <!-- Hero Section -->
    <section>
        <div style="text-align:center;">
            <h2 style="color:white;">Enlaza - Traducción de Lengua de Señas Mexicana</h2>

            <!-- Video container -->
            <div>
                <img id="video" alt="Video en Vivo" />
            </div>

            <!-- Mostrar predicción -->
            <div class="prediction-text">
                <p id="prediction">Esperando predicción...</p>
            </div>
        </div>
    </section>

    <script>
        // Acceder a la cámara y capturar imágenes
        const videoElement = document.getElementById("video");

        async function setupCamera() {
            const stream = await navigator.mediaDevices.getUserMedia({
                video: { facingMode: "user" }  // Usar la cámara frontal
            });
            videoElement.srcObject = stream;
        }

        // Enviar la imagen al servidor para la predicción
        async function sendImageToBackend(imageData) {
            const response = await fetch('/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ image: imageData })
            });
            const data = await response.json();
            document.getElementById("prediction").innerText = data.predicted_class || "Sin predicción";
        }

        // Capturar imagen y enviarla para predicción
        videoElement.addEventListener("play", async () => {
            const canvas = document.createElement("canvas");
            const ctx = canvas.getContext("2d");

            while (true) {
                ctx.drawImage(videoElement, 0, 0, canvas.width, canvas.height);
                const imageData = canvas.toDataURL("image/jpeg").split(',')[1]; // Convertir a base64
                await sendImageToBackend(imageData);  // Enviar al backend
                await new Promise(resolve => setTimeout(resolve, 1000)); // Esperar 1 segundo
            }
        });

        // Iniciar la cámara
        window.onload = setupCamera;
    </script>
</body>
</html>



